#!/bin/bash# –ë—ã—Å—Ç—Ä—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã SSH-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É 176.108.246.49# –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É "Permission denied (publickey)"set -e# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞RED='\033[0;31m'GREEN='\033[0;32m'YELLOW='\033[1;33m'BLUE='\033[0;34m'NC='\033[0m' # No Color# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—èSERVER_IP="176.108.246.49"SSH_USER="root"SSH_DIR="$HOME/.ssh"CONFIG_FILE="$SSH_DIR/config"AUTHORIZED_KEYS="$SSH_DIR/authorized_keys"echo -e "${BLUE}=== –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã SSH-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ===${NC}"echo "–°–µ—Ä–≤–µ—Ä: $SERVER_IP"echo "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: $SSH_USER"echo ""# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏–πinfo() {    echo -e "${YELLOW}‚ÑπÔ∏è  $1${NC}"}success() {    echo -e "${GREEN}‚úÖ $1${NC}"}error() {    echo -e "${RED}‚ùå $1${NC}"}# –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH-–∫–ª—é—á–µ–πcheck_keys() {    info "–ü—Ä–æ–≤–µ—Ä–∫–∞ SSH-–∫–ª—é—á–µ–π..."        if [ ! -f "$SSH_DIR/id_ed25519" ]; then        info "Ed25519 –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–æ–∑–¥–∞–µ–º..."        ssh-keygen -t ed25519 -f "$SSH_DIR/id_ed25519" -N ""        success "Ed25519 –∫–ª—é—á —Å–æ–∑–¥–∞–Ω"    fi        if [ ! -f "$SSH_DIR/id_rsa" ]; then        info "RSA –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–æ–∑–¥–∞–µ–º..."        ssh-keygen -t rsa -b 4096 -f "$SSH_DIR/id_rsa" -N ""        success "RSA –∫–ª—é—á —Å–æ–∑–¥–∞–Ω"    fi        success "SSH-–∫–ª—é—á–∏ –≥–æ—Ç–æ–≤—ã"    echo ""}# –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏create_config() {    info "–°–æ–∑–¥–∞–Ω–∏–µ SSH –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏..."        mkdir -p "$SSH_DIR"    chmod 700 "$SSH_DIR"        cat > "$CONFIG_FILE" << EOF# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ $SERVER_IPHost $SERVER_IP    HostName $SERVER_IP    User $SSH_USER    Port 22    IdentityFile $SSH_DIR/id_ed25519    IdentitiesOnly yes    StrictHostKeyChecking yes    UserKnownHostsFile $SSH_DIR/known_hosts    PreferredAuthentications publickey    ServerAliveInterval 60    ServerAliveCountMax 3# –ê–ª–∏–∞—Å—ã –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞Host normaldance-server    HostName $SERVER_IP    User $SSH_USER    IdentityFile $SSH_DIR/id_ed25519    IdentitiesOnly yes    StrictHostKeyChecking yes    UserKnownHostsFile $SSH_DIR/known_hosts    PreferredAuthentications publickey    ServerAliveInterval 60    ServerAliveCountMax 3Host normaldance-server-rsa    HostName $SERVER_IP    User $SSH_USER    IdentityFile $SSH_DIR/id_rsa    IdentitiesOnly yes    StrictHostKeyChecking yes    UserKnownHostsFile $SSH_DIR/known_hosts    PreferredAuthentications publickey    ServerAliveInterval 60    ServerAliveCountMax 3EOF    chmod 600 "$CONFIG_FILE"    success "SSH –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞"    echo ""}# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—ètest_connection() {    info "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è..."        if ssh -o BatchMode=yes -o ConnectTimeout=10 "$SSH_USER@$SERVER_IP" "echo '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ'" 2>/dev/null; then        success "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!"        return 0    else        error "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"        return 1    fi}# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞get_public_key() {    local key_type="$1"    local public_key="$SSH_DIR/id_${key_type}.pub"        if [ -f "$public_key" ]; then        cat "$public_key"    else        error "–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á $public_key –Ω–µ –Ω–∞–π–¥–µ–Ω"        return 1    fi}# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –∫–ª—é—á–∞show_key_add_instructions() {    info "üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:"    echo ""    echo "1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É –ª—é–±—ã–º –¥–æ—Å—Ç—É–ø–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º:"    echo "   ssh normaldance-server-rsa  # –ï—Å–ª–∏ RSA –∫–ª—é—á —Ä–∞–±–æ—Ç–∞–µ—Ç"    echo ""    echo "2. –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à Ed25519 –∫–ª—é—á –≤ authorized_keys:"    echo "   mkdir -p ~/.ssh"    echo "   chmod 700 ~/.ssh"    echo "   echo '$(get_public_key ed25519)' >> ~/.ssh/authorized_keys"    echo "   chmod 600 ~/.ssh/authorized_keys"    echo ""    echo "3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:"    echo "   ssh normaldance-server"    echo ""    echo "–ò–õ–ò –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥:"    echo "   ssh-copy-id -i ~/.ssh/id_ed25519.pub $SSH_USER@$SERVER_IP"    echo ""}# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—èshow_alternative_solutions() {    info "üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:"    echo ""    echo "1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ RSA –∫–ª—é—á (–µ—Å–ª–∏ Ed25519 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç):"    echo "   ssh -i ~/.ssh/id_rsa $SSH_USER@$SERVER_IP"    echo "   # –∏–ª–∏"    echo "   ssh normaldance-server-rsa"    echo ""    echo "2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:"    echo "   - ~/.ssh/ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ 700"    echo "   - ~/.ssh/authorized_keys –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ 600"    echo "   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ authorized_keys –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≤–∞—à–µ–≥–æ –∫–ª—é—á–∞"    echo ""    echo "3. –ï—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:"    echo "   - –î–æ–±–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å"    echo "   - –ò–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —Å–µ—Ä–≤–µ—Ä–∞"    echo ""    echo "4. –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:"    echo "   ssh -vvv normaldance-server"    echo ""}# –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Åmain() {    echo "–ù–∞—á–∏–Ω–∞—é –±—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã SSH..."    echo ""        check_keys    create_config        if test_connection; then        success "üéâ –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞! –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç."        echo ""        echo "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:"        echo "  ssh normaldance-server"        echo "  ssh $SSH_USER@$SERVER_IP"        exit 0    fi        echo ""    show_key_add_instructions    show_alternative_solutions        echo ""    info "üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:"    echo "  ssh -v normaldance-server    # –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥"    echo "  ssh -T normaldance-server    # –¢–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∞"    echo "  ssh-keygen -l -f ~/.ssh/id_ed255.pub  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞"    echo ""        success "–°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–µ–Ω. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤—ã—à–µ."}# –ó–∞–ø—É—Å–∫main "$@"