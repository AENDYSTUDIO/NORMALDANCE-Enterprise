#!/bin/bash# –°–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSH-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É 176.108.246.49# –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É "Permission denied (publickey)"set -e# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞RED='\033[0;31m'GREEN='\033[0;32m'YELLOW='\033[1;33m'NC='\033[0m' # No Color# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µSERVER_IP="176.108.246.49"SSH_USER="root" # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—èSSH_KEY_PATH="$HOME/.ssh/id_ed25519"SSH_KEY_PUB="$SSH_KEY.pub"SSH_CONFIG_FILE="$HOME/.ssh/config"AUTHORIZED_KEYS_FILE="/home/$SSH_USER/.ssh/authorized_keys"echo -e "${GREEN}=== SSH Setup Script for $SERVER_IP ===${NC}"# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è SSH-–∫–ª—é—á–µ–πcheck_ssh_keys() {    echo -e "${YELLOW}1. –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH-–∫–ª—é—á–µ–π...${NC}"        if [ ! -f "$SSH_KEY_PATH" ]; then        echo -e "${RED}–û—à–∏–±–∫–∞: –ó–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á $SSH_KEY_PATH –Ω–µ –Ω–∞–π–¥–µ–Ω${NC}"        echo "–°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π SSH-–∫–ª—é—á Ed25519..."        ssh-keygen -t ed25519 -f "$SSH_KEY_PATH" -N ""        echo -e "${GREEN}–ù–æ–≤—ã–π –∫–ª—é—á —Å–æ–∑–¥–∞–Ω: $SSH_KEY_PATH${NC}"    fi        if [ ! -f "$SSH_KEY_PUB" ]; then        echo -e "${RED}–û—à–∏–±–∫–∞: –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á $SSH_KEY_PUB –Ω–µ –Ω–∞–π–¥–µ–Ω${NC}"        exit 1    fi        echo -e "${GREEN}SSH-–∫–ª—é—á–∏ –Ω–∞–π–¥–µ–Ω—ã:${NC}"    echo "–ó–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á: $SSH_KEY_PATH"    echo "–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á: $SSH_KEY_PUB"    echo "–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞:"    cat "$SSH_KEY_PUB"    echo ""}# –°–æ–∑–¥–∞–Ω–∏–µ SSH-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏create_ssh_config() {    echo -e "${YELLOW}2. –°–æ–∑–¥–∞–Ω–∏–µ SSH-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...${NC}"        mkdir -p "$HOME/.ssh"        cat > "$SSH_CONFIG_FILE" << EOF# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ $SERVER_IPHost $SERVER_IP    HostName $SERVER_IP    User $SSH_USER    Port 22    IdentityFile $SSH_KEY_PATH    IdentitiesOnly yes    StrictHostKeyChecking yes    UserKnownHostsFile ~/.ssh/known_hosts    PreferredAuthentications publickey    ServerAliveInterval 60    ServerAliveCountMax 3# –ê–ª–∏–∞—Å –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞Host normaldance-server    HostName $SERVER_IP    User $SSH_USER    IdentityFile $SSH_KEY_PATH    IdentitiesOnly yes    StrictHostKeyChecking yes    UserKnownHostsFile ~/.ssh/known_hosts    PreferredAuthentications publickey    ServerAliveInterval 60    ServerAliveCountMax 3EOF    chmod 600 "$SSH_CONFIG_FILE"    echo -e "${GREEN}SSH-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: $SSH_CONFIG_FILE${NC}"}# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—ètest_connection() {    echo -e "${YELLOW}3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...${NC}"        if ssh -o BatchMode=yes -o ConnectTimeout=10 "$SERVER_IP" "echo 'SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ'"; then        echo -e "${GREEN}‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É —É—Å–ø–µ—à–Ω–æ!${NC}"        return 0    else        echo -e "${RED}‚ùå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å. –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.${NC}"        return 1    fi}# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä (—Ç—Ä–µ–±—É–µ—Ç –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)add_key_to_server() {    echo -e "${YELLOW}4. –ü–æ–ø—ã—Ç–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä...${NC}"        # –ü–æ–ª—É—á–∞–µ–º –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á    PUBLIC_KEY=$(cat "$SSH_KEY_PUB")        # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –∫–æ–º–∞–Ω–¥—É –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–∞    COMMAND="mkdir -p ~/.ssh && echo '$PUBLIC_KEY' >> ~/.ssh/authorized_keys && chmod 600 ~/.ssh/authorized_keys && echo '–ö–ª—é—á —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω'"        echo "–î–æ–±–∞–≤–ª—è–µ–º –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä..."    if ssh-copy-id -i "$SSH_KEY_PUB" "$SSH_USER@$SERVER_IP"; then        echo -e "${GREEN}‚úÖ –ö–ª—é—á —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä!${NC}"        return 0    else        echo -e "${RED}‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á —Å ssh-copy-id${NC}"        echo "–ü–æ–ø—ã—Ç–∫–∞ —Ä—É—á–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è..."                # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ —Å –ø–∞—Ä–æ–ª–µ–º        if sshpass -p "$(read -s -p '–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: ' pass; echo "$pass")" \            ssh -o StrictHostKeyChecking=no "$SSH_USER@$SERVER_IP" "$COMMAND"; then            echo -e "${GREEN}‚úÖ –ö–ª—é—á —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤—Ä—É—á–Ω—É—é!${NC}"            return 0        else            echo -e "${RED}‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á –≤—Ä—É—á–Ω—É—é${NC}"            return 1        fi    fi}# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º RSA –∫–ª—é—á–∞use_rsa_key() {    echo -e "${YELLOW}5. –ü–æ–ø—ã—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è RSA –∫–ª—é—á–∞...${NC}"        RSA_KEY="$HOME/.ssh/id_rsa"    if [ -f "$RSA_KEY" ]; then        echo "–ù–∞–π–¥–µ–Ω RSA –∫–ª—é—á: $RSA_KEY"                # –í—Ä–µ–º–µ–Ω–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ RSA –∫–ª—é—á        sed -i "s|IdentityFile $SSH_KEY_PATH|IdentityFile $RSA_KEY|g" "$SSH_CONFIG_FILE"                if test_connection; then            echo -e "${GREEN}‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å RSA –∫–ª—é—á–æ–º —É—Å–ø–µ—à–Ω–æ!${NC}"            echo "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ Ed25519 –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ"            return 0        else            echo -e "${RED}‚ùå RSA –∫–ª—é—á —Ç–∞–∫–∂–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç${NC}"            # –í–æ–∑–≤—Ä–∞—â–∞–µ–º Ed25519 –∫–ª—é—á            sed -i "s|IdentityFile $RSA_KEY|IdentityFile $SSH_KEY_PATH|g" "$SSH_CONFIG_FILE"            return 1        fi    else        echo -e "${YELLOW}‚ö†Ô∏è  RSA –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–æ–∑–¥–∞–µ–º...${NC}"        ssh-keygen -t rsa -b 4096 -f "$RSA_KEY" -N ""        echo -e "${GREEN}RSA –∫–ª—é—á —Å–æ–∑–¥–∞–Ω: $RSA_KEY${NC}"        use_rsa_key    fi}# –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Åmain() {    echo "–ù–∞—á–∏–Ω–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É $SERVER_IP"    echo ""        check_ssh_keys    create_ssh_config        if test_connection; then        echo -e "${GREEN}üéâ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!${NC}"        echo "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è:"        echo "ssh $SERVER_IP"        echo "ssh normaldance-server"        exit 0    fi        echo ""    echo "–û—Å–Ω–æ–≤–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å, –ø—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã..."        if add_key_to_server; then        if test_connection; then            echo -e "${GREEN}üéâ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!${NC}"            echo "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è:"            echo "ssh $SERVER_IP"            echo "ssh normaldance-server"            exit 0        fi    fi        echo ""    echo "–ü—Ä–æ–±—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RSA –∫–ª—é—á..."        if use_rsa_key; then        echo ""        echo -e "${YELLOW}‚ö†Ô∏è  –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —Å RSA –∫–ª—é—á–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç${NC}"        echo "–î–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:"        echo "1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É: ssh normaldance-server"        echo "2. –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à Ed25519 –∫–ª—é—á –≤ ~/.ssh/authorized_keys"        echo "3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É SSH"    else        echo ""        echo -e "${RED}‚ùå –í—Å–µ –º–µ—Ç–æ–¥—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–µ —É–¥–∞–ª–æ—Å—å${NC}"        echo ""        echo "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:"        echo "1. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤–∞—à–µ–≥–æ –∫–ª—é—á–∞"        echo "2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–æ–ª—å–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞)"        echo "3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:"        echo "   - ~/.ssh/authorized_keys –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"        echo "   - –ü—Ä–∞–≤–∞ –Ω–∞ ~/.ssh/ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å 700"        echo "   - –ü—Ä–∞–≤–∞ –Ω–∞ authorized_keys –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å 600"        exit 1    fi}# –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏main "$@"